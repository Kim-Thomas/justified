function justifiedGrid(a){function e(a){return a.width()>=a.height()?"l":"p"}function f(a){a.each(function(a){$(this).attr("data-index",a),$(this).addClass("hgrid-item loaded"),$(this).removeClass("resized")}),a.each(function(){$(this).css("width",$(this).find("img").width()),$(this).css("height",$(this).find("img").height()),$(this).addClass("resized")}),orientations=new Array,a.each(function(){orientations.push(e($(this)))})}function g(){$(window).width()>=960&&(max_line_score=8),$(window).width()>=660&&$(window).width()<=960&&(max_line_score=6),$(window).width()<=660&&(max_line_score=4);var a=0,b=orientations.length;lines=new Array;var c=new Array;line_score=new Array,orientations.forEach(function(d,e){"l"==d?a+2<=max_line_score?e!=b-1?(a+=2,c.push($(".hgrid-item[data-index="+e+"]"))):(a+=2,line_score.push(a),c.push($(".hgrid-item[data-index="+e+"]")),lines.push(c)):e!=b-1?(line_score.push(a),a=2,lines.push(c),c=new Array,c.push($(".hgrid-item[data-index="+e+"]"))):(line_score.push(a),a=2,line_score.push(a),lines.push(c),c=new Array,c.push($(".hgrid-item[data-index="+e+"]")),lines.push(c)):a+1<=max_line_score?e!=b-1?(a+=1,c.push($(".hgrid-item[data-index="+e+"]"))):(a+=1,line_score.push(a),c.push($(".hgrid-item[data-index="+e+"]")),lines.push(c)):e!=b-1?(line_score.push(a),a=1,lines.push(c),c=new Array,c.push($(".hgrid-item[data-index="+e+"]"))):(line_score.push(a),a=1,line_score.push(a),lines.push(c),c=new Array,c.push($(".hgrid-item[data-index="+e+"]")),lines.push(c))})}function h(){lines.forEach(function(a,c){if(line_score[c]>=max_line_score-1){a.length;$theContainer=b;var e=$theContainer.width()-2,f=0,g=[],h=[],i=[],k=0;a.forEach(function(a,b){var c=a.width(),d=a.height();g.push(c),h.push(d),i.push(c/d),k+=1});var l=[],m=0;for(p=0;k-1>=p;p++){for(j=0;j<=k-1;j++)m+=i[j]/i[p];var n=(e-(k-1)*f)/m;l.push(n),m=0}var o=l[0]/i[0],p=0;a.forEach(function(a,b){a.css({height:o,width:l[p]}),a.animate({opacity:1},500),p+=1})}else{a.length;if($theContainer=b,line_score[c]<=max_line_score/2)var e=$theContainer.width()/2-2;else var e=$theContainer.width()-$theContainer.width()/3-2;var f=0,g=[],h=[],i=[],k=0;a.forEach(function(a,b){var c=a.width(),d=a.height();g.push(c),h.push(d),i.push(c/d),k+=1});var l=[],m=0;for(p=0;k-1>=p;p++){for(j=0;j<=k-1;j++)m+=i[j]/i[p];var n=(e-(k-1)*f)/m;l.push(n),m=0}var o=l[0]/i[0],p=0;a.forEach(function(a,b){a.css({height:o,width:l[p]}),a.animate({opacity:1},500),p+=1})}})}var b=$(a.gridContainer),c=$(a.gridItems),d=a.enableImagesLoaded;this.reInitGrid=function(){c.each(function(){$(this).attr("style","")}),f(c),g(),h()},this.initGrid=function(){var a=this;if(d)b.imagesLoaded(function(){f(c),g(),h()});else{var e=$("#div").find("img, iframe"),i=e.length,j=0;e.on("load",function(){j++,j==i&&(f(c),g(),h())}),a.reInitGrid()}$(window).on("resize",function(){a.reInitGrid()})}}